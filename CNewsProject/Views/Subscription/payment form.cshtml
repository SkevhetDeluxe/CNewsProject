
<div>
	<h1>@Model.Title</h1>
	<p>@Model.Summary</p>
	<div id="read-more-content" style="display:none;">
	<p>@Model.FullContent</p>
        <button id="pay-button">Pay Now</button>
        <div id="payment-section" style="display:none;">
            <form id="payment-form">
                <div id="card-element">
                    <!-- Stripe will insert the payment form here(test) -->
                </div>
                <button type="submit">Submit Payment</button>
                <div id="card-errors" role="alert"></div>
            </form>
        </div>
    </div>
    <button id="read-more-button">Read More</button>
</div>

<script type="text/javascript">
	<script src="https://js.stripe.com/v3/" ></script>
<script>
	const stripe = Stripe('pk_test_51PpQ0VESeNuo0minP3UC6ryvrQoZoRFOd3j9iTfxxuXQEWqkgGe0HUAQeFXv2TeaXuxQKnbye3rtyg4mGdMPZw6r00o1HADNNs');
	const elements = stripe.elements();
	const card = elements.create('card');
	card.mount('#card-element');
	const form = document.getElementById('payment-form');
	form.addEventListener('submit', async (event) => {
		event.preventDefault();
		const { token, error } = await stripe.createToken(card);

		if (error) {
			document.getElementById('card-errors').textContent = error.message;
		} else {
			fetch('/Payment/Charge', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json',
				},
				body: JSON.stringify({ token: token.id }),
			}).then(response => response.json())
				.then(data => {
					if (data.success) {
						alert('Payment successful!');
					} else {
						alert('Payment failed.');
					}
				});
		}
	});

	// Show the payment section when the "Pay Now" button is clicked
	document.getElementById('pay-button').addEventListener('click', () => {
		document.getElementById('payment-section').style.display = 'block';
	});

	// Optionally, show the "Read More" content when the "Read More" button is clicked
	document.getElementById('read-more-button').addEventListener('click', () => {
		document.getElementById('read-more-content').style.display = 'block';
	});
</script>