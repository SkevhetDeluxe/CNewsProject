@model WeatherStats
@inject IWeatherApiHandler _handler

@{
	//string weatherTime = DateTime.Now.ToString("yyyy-MM-dd HH:00:00");
	//DateTime testTime = Convert.ToDateTime(weatherTime);
	WeatherStats stats = new();
	string city = "Stockholm";
	string hourMin = DateTime.Now.ToString("HH:mm");
	int hour = DateTime.Now.Hour;
	int condition;
	string conditionStr;
	
	if (!Model.IsPlaceholder)
	{
		condition = Model.hourly.weather_code[hour]; //"Condition not available"

		conditionStr = _handler.GetConditionFromInt(condition);
	}
	else
	{
		conditionStr = "Loading";
		Model.NameOfCity = "Stockholm";
	}
}

<div class="weather-details">
	<div class="weather-info">
		<div class="card">
			<div class="card-body">
				<div style="background-color:#dee6ef;">
					<h3 id="place" >Weather: @Model.NameOfCity</h3>
				</div>
				<form>
					<div class="mt-3">
						<label for=" City" class="form-label">City:</label><br />
						<input type="text" class="form-control" id="city" placeholder="@Model.NameOfCity" default="@city" />
					</div>
				</form>

				<div class="p-2 ps-0">
					<button class="btn-sm" id="searchcity" onclick="FindNewCity(Search())">Find</button>
				</div>
			
				<p>Time: @hourMin</p>
				<p>Temperature:  @{
						if(!Model.IsPlaceholder)
						{
							@Model.current.temperature_2m
						}
					} °C</p>
				@* <p>Temperature: @Model.hourly.temperature_2m[hour] °C</p> *@
				<p>Condition: @conditionStr</p>
				<p><a href="https://www.smhi.se/en/q/Linköping/2694762">Weather SMHI</a></p>
			</div>
		</div>
	</div>

</div>

<script type="text/javascript">
	function Search() {
		return document.getElementById('city').value;
	}
</script>
